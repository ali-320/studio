{
  "entities": {
    "user": {
      "title": "User",
      "description": "Represents a user of the application.",
      "type": "object",
      "properties": {
        "role": {
          "type": "string",
          "description": "The user's role.",
          "enum": ["anonymous", "registered", "volunteer", "admin"]
        },
        "name": {
          "type": "string",
          "description": "The user's full name."
        },
        "email": {
            "type": "string",
            "format": "email",
            "description": "The user's email address."
        },
        "phone": {
          "type": "string",
          "description": "The user's phone number."
        },
        "location": {
          "type": "object",
          "properties": {
            "latitude": { "type": "number" },
            "longitude": { "type": "number" }
          },
          "description": "The user's last known location (GeoPoint)."
        },
        "currentLocationAddress": {
            "type": "string",
            "description": "The address for the user's current location."
        },
        "status": {
            "type": "string",
            "description": "The user's current status.",
            "enum": ["available", "offline", "responding"]
        },
        "fcmToken": {
            "type": "string",
            "description": "Firebase Cloud Messaging token for push notifications."
        }
      },
      "required": ["role", "email"]
    },
    "savedLocation": {
        "title": "Saved Location",
        "description": "A location saved by a user.",
        "type": "object",
        "properties": {
            "name": { "type": "string", "description": "The user-assigned name for the location (e.g., Home, Office)." },
            "address": { "type": "string", "description": "The full address of the location." },
            "latitude": { "type": "number" },
            "longitude": { "type": "number" }
        },
        "required": ["name", "address", "latitude", "longitude"]
    },
    "alert": {
      "title": "Alert",
      "description": "Represents a flood alert.",
      "type": "object",
      "properties": {
        "location": {
            "type": "object",
            "properties": {
                "latitude": { "type": "number" },
                "longitude": { "type": "number" }
            },
            "description": "The location of the alert (GeoPoint)."
        },
        "riskScore": {
          "type": "string",
          "description": "The calculated risk score.",
          "enum": ["Low", "Medium", "High"]
        },
        "status": {
            "type": "string",
            "description": "The status of the alert.",
            "enum": ["active", "accepted", "resolved"]
        },
        "assignedVolunteer": {
            "type": "string",
            "description": "The UID of the volunteer assigned to this alert."
        },
        "resolvedBy": {
            "type": "string",
            "description": "The UID of the user who resolved this alert."
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "The time the alert was created."
        }
      },
      "required": ["location", "riskScore", "status", "timestamp"]
    },
    "volunteerApplication": {
        "title": "Volunteer Application",
        "description": "Represents a user's application to become a volunteer.",
        "type": "object",
        "properties": {
            "userId": { "type": "string", "description": "The UID of the user applying." },
            "name": { "type": "string", "description": "The applicant's name." },
            "expertise": { "type": "string", "description": "The applicant's listed expertise." },
            "status": { "type": "string", "enum": ["pending", "approved", "rejected"], "description": "The application status." }
        },
        "required": ["userId", "name", "status"]
    },
    "incidentReport": {
        "title": "Incident Report",
        "description": "Represents a detailed report filed by a volunteer for an alert.",
        "type": "object",
        "properties": {
            "alertId": { "type": "string", "description": "The ID of the parent alert." },
            "volunteerId": { "type": "string", "description": "The ID of the volunteer filing the report." },
            "casualties": { "type": "number" },
            "injuries": { "type": "number" },
            "safetyStatus": { "type": "string" },
            "lossEstimate": { "type": "number" },
            "timestamp": { "type": "string", "format": "date-time" }
        },
        "required": ["alertId", "volunteerId", "timestamp"]
    },
    "volunteerChat": {
      "title": "Volunteer Chat",
      "description": "A message in the volunteer chat.",
      "type": "object",
      "properties": {
        "userId": { "type": "string", "description": "The UID of the user who sent the message." },
        "userName": { "type": "string", "description": "The name of the user who sent the message." },
        "text": { "type": "string", "description": "The content of the chat message." },
        "timestamp": { "type": "string", "format": "date-time", "description": "When the message was sent." }
      },
      "required": ["userId", "userName", "text", "timestamp"]
    },
    "news": {
      "title": "News Cache",
      "description": "Stores cached news articles for a specific location to avoid refetching.",
      "type": "object",
      "properties": {
        "articles": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "title": { "type": "string" },
              "summary": { "type": "string" },
              "source": { "type": "string" },
              "url": { "type": "string", "format": "uri" }
            },
            "required": ["title", "summary", "source", "url"]
          }
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time"
        }
      },
      "required": ["articles", "updatedAt"]
    }
  },
  "auth": {
    "providers": ["email"]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": { "$ref": "#/entities/user" },
      "description": "Stores user profiles."
    },
    "/users/{userId}/savedLocations/{locationId}": {
        "schema": { "$ref": "#/entities/savedLocation" },
        "description": "Stores a user's saved locations."
    },
    "/alerts/{alertId}": {
      "schema": { "$ref": "#/entities/alert" },
      "description": "Stores all active and resolved flood alerts."
    },
    "/volunteerApplications/{applicationId}": {
      "schema": { "$ref": "#/entities/volunteerApplication" },
      "description": "Stores applications from users wishing to become volunteers."
    },
    "/incidentReports/{reportId}": {
        "schema": { "$ref": "#/entities/incidentReport" },
        "description": "Stores detailed incident reports from volunteers."
    },
    "/volunteerChats/{chatId}": {
      "schema": { "$ref": "#/entities/volunteerChat" },
      "description": "Stores chat messages for volunteers."
    },
    "/news/{locationId}": {
      "schema": { "$ref": "#/entities/news" },
      "description": "Caches news articles for a given location, where the document ID is a sanitized version of the location name."
    }
  }
}
