{
  "entities": {
    "user": {
      "title": "User",
      "description": "Represents a user of the application.",
      "type": "object",
      "properties": {
        "role": {
          "type": "string",
          "description": "The user's role.",
          "enum": ["anonymous", "registered", "volunteer", "admin"]
        },
        "name": {
          "type": "string",
          "description": "The user's full name."
        },
        "phone": {
          "type": "string",
          "description": "The user's phone number."
        },
        "location": {
          "type": "object",
          "properties": {
            "latitude": { "type": "number" },
            "longitude": { "type": "number" }
          },
          "description": "The user's last known location (GeoPoint)."
        },
        "savedLocations": {
            "type": "object",
            "description": "A map of saved location names to addresses for the user."
        },
        "currentLocationName": {
            "type": "string",
            "description": "The display name for the user's current location."
        },
        "status": {
            "type": "string",
            "description": "The user's current status.",
            "enum": ["available", "offline", "responding"]
        },
        "fcmToken": {
            "type": "string",
            "description": "Firebase Cloud Messaging token for push notifications."
        }
      },
      "required": ["role"]
    },
    "alert": {
      "title": "Alert",
      "description": "Represents a flood alert.",
      "type": "object",
      "properties": {
        "location": {
            "type": "object",
            "properties": {
                "latitude": { "type": "number" },
                "longitude": { "type": "number" }
            },
            "description": "The location of the alert (GeoPoint)."
        },
        "riskScore": {
          "type": "string",
          "description": "The calculated risk score.",
          "enum": ["Low", "Medium", "High"]
        },
        "status": {
            "type": "string",
            "description": "The status of the alert.",
            "enum": ["active", "accepted", "resolved"]
        },
        "assignedVolunteer": {
            "type": "string",
            "description": "The UID of the volunteer assigned to this alert."
        },
        "resolvedBy": {
            "type": "string",
            "description": "The UID of the user who resolved this alert."
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "The time the alert was created."
        }
      },
      "required": ["location", "riskScore", "status", "timestamp"]
    },
    "volunteerApplication": {
        "title": "Volunteer Application",
        "description": "Represents a user's application to become a volunteer.",
        "type": "object",
        "properties": {
            "userId": { "type": "string", "description": "The UID of the user applying." },
            "name": { "type": "string", "description": "The applicant's name." },
            "expertise": { "type": "string", "description": "The applicant's listed expertise." },
            "status": { "type": "string", "enum": ["pending", "approved", "rejected"], "description": "The application status." }
        },
        "required": ["userId", "name", "status"]
    },
    "incidentReport": {
        "title": "Incident Report",
        "description": "Represents a detailed report filed by a volunteer for an alert.",
        "type": "object",
        "properties": {
            "alertId": { "type": "string", "description": "The ID of the parent alert." },
            "volunteerId": { "type": "string", "description": "The ID of the volunteer filing the report." },
            "casualties": { "type": "number" },
            "injuries": { "type": "number" },
            "safetyStatus": { "type": "string" },
            "lossEstimate": { "type": "number" },
            "timestamp": { "type": "string", "format": "date-time" }
        },
        "required": ["alertId", "volunteerId", "timestamp"]
    }
  },
  "auth": {
    "providers": ["phone"]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": { "$ref": "#/entities/user" },
      "description": "Stores user profiles."
    },
    "/alerts/{alertId}": {
      "schema": { "$ref": "#/entities/alert" },
      "description": "Stores all active and resolved flood alerts."
    },
    "/volunteerApplications/{applicationId}": {
      "schema": { "$ref": "#/entities/volunteerApplication" },
      "description": "Stores applications from users wishing to become volunteers."
    },
    "/incidentReports/{reportId}": {
        "schema": { "$ref": "#/entities/incidentReport" },
        "description": "Stores detailed incident reports from volunteers."
    }
  }
}
